name: Merge or push to main workflow

on:

  workflow_dispatch:

  push:
    branches: ["main"]
    paths-ignore:
      - 'README.md'
      - '.github/**'

jobs:
  build:
    name: Upload Release Asset
    runs-on: self-hosted
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Get current date
        id: date
        run: echo "::set-output name=date::$(date +'%Y%m%d')"

      - name: Trigger Docker Build and Push Workflow
        uses: ./.github/workflows/docker-build-push.yml
        with:
          docker_tags: deduard/tools:cloudflare-dns-ip-updater-${{ steps.date.outputs.date }}